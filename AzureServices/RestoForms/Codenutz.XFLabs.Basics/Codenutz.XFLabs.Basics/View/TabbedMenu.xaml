<?xml version="1.0" encoding="utf-8" ?>
<TabbedPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Codenutz.XFLabs.Basics.View.TabbedMenu"
             xmlns:controls="clr-namespace:XLabs.Forms.Controls;assembly=XLabs.Forms"
             xmlns:resources ="clr-namespace:Codenutz.XFLabs.Basics.Resx.AppResource;assembly=Codenutz.XFLabs.Basics"
             xmlns:b="clr-namespace:Xamarin.Behaviors;assembly=Xamarin.Behaviors"
             xmlns:Intlocal="clr-namespace:Codenutz.XFLabs.Basics.Helpers;assembly=Codenutz.XFLabs.Basics"
             x:Name="TabMenuPage"
             Title="{Binding Title}"
	           IsBusy="{Binding IsBusy}" >
  <TabbedPage.Resources>
    <ResourceDictionary>
      <Intlocal:IntegerToStringConverter x:Key="DigitConvert"> </Intlocal:IntegerToStringConverter>
  </ResourceDictionary>
  </TabbedPage.Resources>
  
  <TabbedPage.ItemTemplate>
    <DataTemplate>
      <ContentPage Title="{Binding MenuCategory}" Icon="ic_lovred.png" BackgroundColor="White">
        <StackLayout Padding="0,2,0,2" Spacing="0">
          <ListView x:Name="list" ItemsSource="{Binding MenuList}"
                 ItemTapped="OnItemSelected"
                 VerticalOptions="FillAndExpand"
                 SeparatorColor="Black"
                 HasUnevenRows="true" >
            <ListView.ItemTemplate>
              <DataTemplate>
                <ViewCell>
                  <Grid>
                  <Grid.Padding>
                    <OnPlatform x:TypeArguments="Thickness">
                      <OnPlatform.iOS>
                        10,5,10,5
                      </OnPlatform.iOS>
                      <OnPlatform.Android>
                        10,5,10,5
                      </OnPlatform.Android>
                      <OnPlatform.WinPhone>
                        20,25,20,25
                      </OnPlatform.WinPhone>
                    </OnPlatform>
                  </Grid.Padding>
                    <Grid.RowDefinitions>
                      <RowDefinition Height="Auto"></RowDefinition>
                      <RowDefinition Height="Auto"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="100"></ColumnDefinition>
                      <ColumnDefinition Width="*"></ColumnDefinition>
                      <ColumnDefinition Width="40"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Row="0" Grid.Column="0" 
                           Source="{Binding ThumbUrl}" 
                           HeightRequest="91" Aspect="AspectFill"/>
                    
                    <StackLayout Grid.Column="1"
                             Padding="8"
                             Spacing="2"
                             VerticalOptions="Center">
                      <Label Text="{Binding Name}" FontSize = "Medium"  LineBreakMode="TailTruncation"></Label>
                      <Label FontSize = "Small" Text="Price: $10.00" LineBreakMode="TailTruncation"></Label>

                      <StackLayout HorizontalOptions="Start"  Orientation="Horizontal">

                        <Label FontSize = "Small" Text="Add:" 
                               HorizontalOptions="Start" 
                               VerticalOptions="Center"  
                               LineBreakMode="TailTruncation"></Label>
                        
                        <controls:CheckBox DefaultText=""
                                           CheckedChanged="OnCheckBoxChanged"
                                           HeightRequest="40"
                                           WidthRequest="35"
                                           HorizontalOptions="Start"
                                           VerticalOptions="Start"
                                           />
                       
                        <Label FontSize = "Small" Text="Quantity:"
                               HorizontalOptions="Start"
                               VerticalOptions="Center"
                               LineBreakMode="TailTruncation" />

                        <Entry Keyboard="Telephone">
                          <b:Interaction.Behaviors>
                            <b:BehaviorCollection>
                              <b:TextChangedBehavior Text="{Binding QuantityOrdered, Mode=TwoWay}" />
                              <b:EventToCommand CommandNameContext="{b:RelativeContext TabMenuPage}"
                                EventName="Unfocused" 
                                                CommandName="UnfocusedCommand" 
                                                CommandParameter="{Binding .}" />
                            </b:BehaviorCollection>
                          </b:Interaction.Behaviors>
                        </Entry>
                        
                      </StackLayout>
                    </StackLayout>
                    <Image Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" HeightRequest="12"  
                           Source="arrowright_16.png" HorizontalOptions="Center" />
                    
                  </Grid>
                </ViewCell>
              </DataTemplate>
            </ListView.ItemTemplate>
          </ListView>

        </StackLayout>
      </ContentPage>
    </DataTemplate>
  </TabbedPage.ItemTemplate>
</TabbedPage>